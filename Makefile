# variable
binary=ca

# command
.PHONY: help
help:
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-30s\033[0m %s\n", $$1, $$2}'

.PHONY: build
build: ## build command
	go build ./cmd/ca

.PHONY: test
test: ## run test command
	go test -race -cover ./...

.PHONY: run
run: build ## run sample
	./$(binary) run test2 -v hoge -sv huga

.PHONY: install
install: build ## go install
	cd ./cmd/ca && go install

.PHONY: lint
lint: ## execute lint
	@echo --------------------------------------------------------------------------------------
	@echo golint--------------------------------------------------------------------------------
	@echo --------------------------------------------------------------------------------------
	golint ./...

	@echo --------------------------------------------------------------------------------------
	@echo golangci-lint-------------------------------------------------------------------------
	@echo --------------------------------------------------------------------------------------
	golangci-lint run ./...

	@echo --------------------------------------------------------------------------------------
	@echo go vet--------------------------------------------------------------------------------
	@echo --------------------------------------------------------------------------------------
	go vet ./...

	@echo --------------------------------------------------------------------------------------
	@echo gofmt -s------------------------------------------------------------------------------
	@echo --------------------------------------------------------------------------------------
	-gofmt -s -d . | grep '^'

	@echo --------------------------------------------------------------------------------------
	@echo interfacer----------------------------------------------------------------------------
	@echo --------------------------------------------------------------------------------------
	interfacer ./...

	@echo --------------------------------------------------------------------------------------
	@echo errcheck------------------------------------------------------------------------------
	@echo --------------------------------------------------------------------------------------
	-errcheck ./...
